# Урок 4. Лобби и список игроков

## Цель
- Научиться объявлять вход в лобби через сетевое событие.
- Синхронизировать список игроков.
- Понять роль хоста как координатора лобби.

## Требования
- Python 3.7+
- spritePro доступен в проекте

## Теория (кратко)
- Лобби — отдельное состояние до начала игры.
- Событие `join` сообщает о входе игрока.
- Хост поддерживает список игроков и рассылает `roster`.

## EventBus и прямые сообщения
- EventBus — для игровых событий (shoot, ready, start), удобно иметь подписчиков.
- Прямые `net.send()`/`send_every()` — для частых пакетов (позиции), меньше оверхеда.
- EventBus не заменяет сетевой слой, это просто удобная надстройка.

## Практика
1. Запустите `example_lobby.py`.
1. Обратите внимание на подпись окна и строку `Я: ...`:
   - видно, кто `host`, кто `client_1`/`client_2`;
   - видно сетевой `id` и роль процесса.
1. В примере используется `clients=3, client_spawn_delay=3`:
   - `host` стартует сразу;
   - `client_1` появляется через 3 сек;
   - `client_2` появляется через 6 сек.
1. Убедитесь, что список игроков (`roster`) одинаков во всех окнах.
1. Посмотрите, как хост формирует `roster` и рассылает его остальным.
1. Для транспортных сетевых логов (`send/recv`) включите `net_debug=True` в `s.networking.run(...)` и смотрите файлы `spritepro_logs/debug_net_host.log`, `debug_net_client_0.log`, `debug_net_client_1.log`.
1. `init_context(..., debug=True)` включает логи контекста в stdout, а не transport-логи в `debug_net_*.log`.

## Вопросы для самопроверки
- Почему roster лучше хранить на хосте?
- Что будет, если два клиента отправят `join` одновременно?
- Как можно обработать выход игрока?

## Задания
- В `practice_lobby.py` заполните логику обновления списка игроков.
- Убедитесь, что список одинаков на всех клиентах.
- Добавьте сортировку имен по алфавиту.
- Сделайте имена клиентов уникальными (`client_1`, `client_2`, ...), чтобы в лобби было понятно, кто есть кто.

## Решение
- См. `solution_lobby.py`.

## Что еще изучить
- Интерполяция и сглаживание движения.
- Авторитетный сервер и базовая валидация.
